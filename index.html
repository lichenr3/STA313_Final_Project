<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Commuter Mode & Emissions Visualization Project</title>
  <meta name="description" content="Interactive visualization storytelling template.">

  <script src="https://cdn.jsdelivr.net/npm/d3@7"></script>
  <script src="https://cdn.plot.ly/plotly-2.27.0.min.js"></script>

  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <link rel="stylesheet" href="css/layout.css">
  <link rel="stylesheet" href="css/vis0.css">
  <link rel="stylesheet" href="css/vis1.css">
  <link rel="stylesheet" href="css/vis2.css">
</head>

<body>

  <div id="app-container">
    <!-- 侧边栏切换按钮 -->
    <button id="sidebar-toggle" class="sidebar-toggle-btn" aria-label="Toggle sidebar">
      <span class="toggle-icon">☰</span>
    </button>

    <aside id="sidebar">

      <div id="vis0-icon-controls" class="control-section active">
        <h3>Section 1: Icon Chart</h3>
        <p class="helper-text">Select regions to view commute mode composition.</p>

        <div class="control-group">
          <label>Region Selection</label>
          <div class="checkbox-group" id="vis0-icon-city-selector">
            <div class="checkbox-dropdown-toggle">
              <span class="selected-text">Overview (All CMAs)</span>
              <i class="checkbox-dropdown-arrow fas fa-chevron-down"></i>
            </div>
            <div class="checkbox-dropdown-content">
              <label class="checkbox-item">
                <input type="checkbox" value="All" checked> Overview (All CMAs)
              </label>
              <label class="checkbox-item">
                <input type="checkbox" value="Toronto" checked> Toronto
              </label>
              <label class="checkbox-item">
                <input type="checkbox" value="Montreal" checked> Montréal
              </label>
              <label class="checkbox-item">
                <input type="checkbox" value="Ottawa" checked> Ottawa-Gatineau
              </label>
              <label class="checkbox-item">
                <input type="checkbox" value="Vancouver" checked> Vancouver
              </label>
              <label class="checkbox-item">
                <input type="checkbox" value="Calgary" checked> Calgary
              </label>
              <label class="checkbox-item">
                <input type="checkbox" value="Edmonton" checked> Edmonton
              </label>
            </div>
          </div>
        </div>
      </div>

      <div id="vis0-comparison-controls" class="control-section">
        <h3>Section 1: Comparison Chart</h3>
        <p class="helper-text">Sort cities by different metrics.</p>

        <div class="control-group">
          <label for="vis0-sort-selector">Sort By</label>
          <select id="vis0-sort-selector">
            <option value="transit">Transit Decline</option>
            <option value="wfh">WFH Growth</option>
            <option value="population">Population</option>
          </select>
        </div>
      </div>

      <div id="vis1-pie-controls" class="control-section">
        <h3>Section 2a: Population Distribution</h3>
        <p class="helper-text">Filter to see population pie chart.</p>

        <div class="control-group">
          <label>Region Selection</label>
          <div class="checkbox-group" id="cma-select-pie">
            <div class="checkbox-dropdown-toggle">
              <span class="selected-text">Overview (All CMAs)</span>
              <i class="checkbox-dropdown-arrow fas fa-chevron-down"></i>
            </div>
            <div class="checkbox-dropdown-content">
              <label class="checkbox-item">
                <input type="checkbox" value="overview" checked> Overview (All CMAs)
              </label>
              <label class="checkbox-item">
                <input type="checkbox" value="Toronto" checked> Toronto
              </label>
              <label class="checkbox-item">
                <input type="checkbox" value="Montreal" checked> Montréal
              </label>
              <label class="checkbox-item">
                <input type="checkbox" value="Ottawa" checked> Ottawa-Gatineau
              </label>
              <label class="checkbox-item">
                <input type="checkbox" value="Vancouver" checked> Vancouver
              </label>
              <label class="checkbox-item">
                <input type="checkbox" value="Calgary" checked> Calgary
              </label>
              <label class="checkbox-item">
                <input type="checkbox" value="Edmonton" checked> Edmonton
              </label>
            </div>
          </div>
        </div>

        <div class="control-group">
          <label>
            Annual Income Bracket: <span id="income-value-pie">$0 - $150,000</span>
          </label>
          <div class="range-slider-container">
            <div class="slider-track"></div>
            <input type="range" id="income-min-pie" min="0" max="150000" step="5000" value="0">
            <input type="range" id="income-max-pie" min="0" max="150000" step="5000" value="150000">
          </div>
        </div>

        <div class="info-panel" id="info-panel-pie">
          <h3>Insights</h3>
          <p>Interact with the pie chart to see details.</p>
        </div>
      </div>

      <div id="vis1-bar-controls" class="control-section">
        <h3>Section 2b: Transit Mode Changes</h3>
        <p class="helper-text">Filter to see commute mode bar chart.</p>

        <div class="control-group">
          <label>Region Selection</label>
          <div class="checkbox-group" id="cma-select-bar">
            <div class="checkbox-dropdown-toggle">
              <span class="selected-text">Overview (All CMAs)</span>
              <i class="checkbox-dropdown-arrow fas fa-chevron-down"></i>
            </div>
            <div class="checkbox-dropdown-content">
              <label class="checkbox-item">
                <input type="checkbox" value="overview" checked> Overview (All CMAs)
              </label>
              <label class="checkbox-item">
                <input type="checkbox" value="Toronto" checked> Toronto
              </label>
              <label class="checkbox-item">
                <input type="checkbox" value="Montreal" checked> Montréal
              </label>
              <label class="checkbox-item">
                <input type="checkbox" value="Ottawa" checked> Ottawa-Gatineau
              </label>
              <label class="checkbox-item">
                <input type="checkbox" value="Vancouver" checked> Vancouver
              </label>
              <label class="checkbox-item">
                <input type="checkbox" value="Calgary" checked> Calgary
              </label>
              <label class="checkbox-item">
                <input type="checkbox" value="Edmonton" checked> Edmonton
              </label>
            </div>
          </div>
        </div>

        <div class="control-group">
          <label>
            Annual Income Bracket: <span id="income-value-bar">$0 - $150,000</span>
          </label>
          <div class="range-slider-container">
            <div class="slider-track"></div>
            <input type="range" id="income-min-bar" min="0" max="150000" step="5000" value="0">
            <input type="range" id="income-max-bar" min="0" max="150000" step="5000" value="150000">
          </div>
        </div>

        <div id="secondary-filters-bar" class="secondary-controls" style="display: block;">
          <div class="control-group">
            <label>Metric Display</label>
            <div class="radio-row">
              <label><input type="radio" name="data-type-bar" value="percentage" checked> Percentage (%)</label>
              <label><input type="radio" name="data-type-bar" value="actual"> Absolute Count</label>
            </div>
          </div>

          <div class="control-group">
            <label>Mode Types</label>
            <div class="checkbox-row">
              <label><input type="checkbox" id="show-public-bar" checked> Public Transit</label>
              <label><input type="checkbox" id="show-private-bar" checked> Private Vehicle</label>
            </div>
          </div>

          <div class="control-group">
            <label>Comparison</label>
            <label><input type="checkbox" id="show-net-change-bar"> Show Net Change (2016-21)</label>
          </div>
        </div>
      </div>

      <div id="vis2-controls" class="control-section">
        <h3>Section 3: Impact Analysis</h3>
        <p class="helper-text">Isolate specific modes to see environmental data.</p>

        <div class="control-group">
          <label for="vis2-mode-select">Commute Mode</label>
          <select id="vis2-mode-select">
            <option value="all">All Modes</option>
          </select>
        </div>

        <div class="control-group">
          <label>Region Selection</label>
          <div class="checkbox-group" id="vis2-CMA-select">
            <div class="checkbox-dropdown-toggle">
              <span class="selected-text">Overview (All CMAs)</span>
              <i class="checkbox-dropdown-arrow fas fa-chevron-down"></i>
            </div>
            <div class="checkbox-dropdown-content">
              <label class="checkbox-item">
                <input type="checkbox" value="all" checked> Overview (All CMAs)
              </label>
            </div>
          </div>
        </div>

        <button id="vis2-reset-btn" class="btn-reset">Reset Impact View</button>

        <div class="summary-box" style="margin-top: 20px; height: auto; max-height: 400px; overflow-y: auto;">
          <h3>Data Summary</h3>
          <div class="table-responsive">
            <table id="vis2-summary-table">
              <thead>
                <tr>
                  <th>Region</th>
                  <th>Commute Mode</th>
                  <th>2016 Share</th>
                  <th>2021 Share</th>
                  <th>Change (pp)</th>
                  <th>Change (%)</th>
                </tr>
              </thead>
              <tbody>
              </tbody>
            </table>
          </div>
          <p id="vis2-no-data-msg" style="display:none; color:#888;">No data for current selection.</p>
        </div>
      </div>

    </aside>

    <!-- 侧边栏拖拽手柄 -->
    <div id="sidebar-resizer" class="sidebar-resizer"></div>

    <main id="main-content">

      <section id="intro" data-controls="vis0-icon-controls">
        <header class="article-header">
          <h1>Toronto Commuting in Context: Remote Work, Mode Shifts, and Emissions</h1>
          <p class="subtitle">A dashboard for Toronto urban planners with benchmarks from Montréal, Ottawa-Gatineau, Vancouver, Calgary, and Edmonton</p>
        </header>
        <div class="narrative-text">
          <p class="lead">
            The COVID-19 pandemic reshaped how people in Canada's largest cities get to work. Remote work surged in many white-collar sectors, and some high-income workers stopped commuting altogether. But for essential, in-person jobs, daily travel never disappeared — and in some neighbourhoods it became longer, less convenient, or more car-dependent.
          </p>
          <br>
          <p>
            This dashboard uses 2016 and 2021 Census data for six major CMAs — Toronto, Montréal, Ottawa-Gatineau, Vancouver, Calgary, and Edmonton — combined with national transport-emissions statistics, to show how commuting changed before and after the pandemic. We focus on social equity and sustainability: tracking which groups kept commuting in person, measuring how their mode choices shifted between transit and private vehicles, and linking those shifts to changes in transportation-related greenhouse-gas emissions.
          </p>
          <br>
          <p>
            Our primary audience is Toronto urban planners and transport staff who need to balance equity and climate goals when investing in infrastructure. The comparisons with the five other CMAs serve as reference points, helping you see whether Toronto's trends are typical or unusually severe.
          </p>
        </div>
      </section>

      <section id="vis0-section">
        <div class="narrative-text">
          <h2>1. Remote Work and Commuting Across Canada's Largest CMAs</h2>
          <p>
            The pandemic fundamentally altered work and commuting patterns across Canada. Use the icon chart below to explore the scale and composition of these changes. Each icon represents a portion of the workforce, color-coded by their primary commute mode or work-from-home status. Select different regions from the sidebar to compare how Toronto's patterns stack up against other major cities.
          </p>
        </div>

        <!-- Icon Chart -->
        <div class="vis0-dashboard-card" data-controls="vis0-icon-controls">
          <h3>The Commuter Shift: Composition & Scale</h3>

          <div class="vis0-chart-grid">
            <div class="vis0-year-label">2016</div>
            <div class="vis0-icon-row" id="vis0-icon-row-2016"></div>

            <div class="vis0-year-label">2021</div>
            <div class="vis0-icon-row" id="vis0-icon-row-2021"></div>
          </div>

          <p class="vis0-subtitle" id="vis0-icon-subtitle"
            style="margin-top: 30px; margin-bottom: 15px; text-align: center;"></p>

          <div class="vis0-legend" style="margin-top: 0; padding-top: 15px;">
            <div class="vis0-legend-item">
              <div class="vis0-legend-dot bg-car"></div> Private Vehicle
            </div>
            <div class="vis0-legend-item">
              <div class="vis0-legend-dot bg-transit"></div> Public Transit
            </div>
            <div class="vis0-legend-item">
              <div class="vis0-legend-dot bg-active"></div> Active / Other
            </div>
            <div class="vis0-legend-item">
              <div class="vis0-legend-dot bg-wfh"></div> Work From Home
            </div>
          </div>
        </div>

        <div class="narrative-text" style="margin-top: 40px;">
          <p>
            Between 2016 and 2021, all six CMAs in this dashboard saw a rise in working from home and a decline in the share of workers who commute every day. At the same time, the composition of commute modes among those who still travel to work shifted: public-transit shares generally fell, while private-vehicle and active-mode shares either held steady or grew slightly, depending on the city. These changes reshape how people move through each region and where transport infrastructure is most heavily used.
          </p>
          <br>
          <p>
            In the icon chart above, select a region to see the overall mix of work-from-home, private-vehicle, public-transit, and active/other commuters in 2016 and 2021. This view gives you a quick sense of scale — which cities have the largest commuting populations, and how big the work-from-home segment has become — before you focus on any specific mode.
          </p>
          <br>
          <p>
            In the city-ranking chart, you can then sort the six CMAs by transit decline, work-from-home growth, or total population. This makes it easy to see where Toronto sits relative to Montréal, Ottawa-Gatineau, Vancouver, Calgary, and Edmonton: for example, whether its drop in transit use is unusually steep given its increase in remote work, or whether it behaves like the other large cities.
          </p>
        </div>

        <div class="narrative-text" style="margin-top: 40px;">
          <h3>Comparing Toronto with Other CMAs</h3>
          <p>
            The ranking chart highlights where each CMA stands on key metrics such as transit decline, work-from-home growth, or total commuters. For Toronto, this view is important: its drop in transit use may look similar in percentage terms to other CMAs, but because Toronto has by far the largest commuting population, even a modest percentage-point change represents a very large number of people and trips.
          </p>
        </div>

        <!-- Comparison Chart -->
        <div class="vis0-comparison-container" data-controls="vis0-comparison-controls">
          <h3>Toronto's Disproportionate Shift</h3>
          <p class="vis0-comparison-subtitle">
            Comparing the <strong>Transit Collapse</strong> vs. the <strong>Remote Work Surge</strong> across 6
            CMAs.<br>
            The scale of the transit drop in Toronto is magnified by its massive population.
          </p>
          <div id="vis0-comparison-chart" style="text-align:center;"></div>
          <p class="vis0-comparison-note">Note: Transit decline correlates with WFH growth, but also reflects shifts to
            private vehicle use.</p>
        </div>

        <div class="narrative-text">
          <p>
            However, these CMA-level summaries still mix together residents with very different levels of choice and flexibility. High-income professionals who could shift fully or partly to remote work are averaged together with low-income essential workers who had to keep commuting in person throughout the pandemic. To understand the implications for social equity, the next section focuses on who kept moving in Toronto’s labour force, where they live, and how their commute modes changed.
          </p>
        </div>
      </section>

      <section id="vis1-pie-section" data-controls="vis1-pie-controls">
        <div class="narrative-text">
          <h2>2. The Demographics: Who Kept Moving?</h2>
          <p>
            While remote work disrupted mobility for many Canadians, a large share of the population actually had to travel to the workplace during the pandemic. Sectors such as food service, retail, maintenance, healthcare support, warehousing, delivery, and transportation require physical presence, pay less, and offer little chance to work from home. The lowest-paying job opportunities often further require in-person attendance.
          </p>
          <br>
          <p>
            The interactive donut chart below lets you explore this variation directly. Hover over a segment to reveal the number and share of essential workers in each city for both 2016 and 2021. Use the sidebar filters to adjust income brackets or select specific regions—this helps you see how Toronto's essential workforce compares to other CMAs, and which populations were most affected by transportation disruptions during the pandemic.
          </p>
        </div>

        <div class="chart-container-wrapper" style="height: 600px;">
          <div id="chart-container-pie" style="width: 100%; height: 100%;">
            <div id="pie-chart-container" style="width: 100%; height: 100%;"></div>
          </div>
        </div>

        <div class="narrative-text" style="margin-top: 40px;">
          <p>
            A large proportion of the low-income workforce has been concentrated in these essential sectors since 2020. More than a quarter of Toronto's workforce and not less than a third in Montréal consisted of low-income essential workers. Western cities such as Vancouver, Edmonton, and Calgary showed smaller shares, totaling only several hundred thousand commuters. Despite regional differences, these cities still maintained large populations of daily commuters who had no option to work remotely.
          </p>
          <br>
          <p>
            The chart highlights that essential workers continue to form a large commuting group in every CMA. Their daily travel is driven by job requirements rather than personal preference, which is why they remain a key focus for equitable transit planning. 
          </p>
        </div>
      </section>

      <section id="vis1-bar-section" data-controls="vis1-bar-controls">
        <div class="narrative-text">
          <h2>Changes in Transit Habits</h2>
          <p>
            Now that we have identified which workers remained on the move, the next question is how they traveled. Did the essential workforce continue using the same commute modes as before, or did the pandemic push them toward different transportation choices? The interactive bar chart below breaks down commute mode shares by income level and industry sector, allowing you to compare 2016 and 2021 side by side.
          </p>
        </div>

        <div class="chart-container-wrapper" style="height: 600px;">
          <div id="chart-container-bar" style="width: 100%; height: 100%;">
            <div id="bar-chart-container" style="width: 100%; height: 100%;"></div>
          </div>
        </div>

        <div class="narrative-text" style="margin-top: 40px;">
          <p>
            The chart reveals that mode shifts were far from uniform. Essential workers in lower-income brackets—those in retail, food service, or healthcare support—were much less able to switch to private vehicles compared to higher-income professionals. This disparity underscores a fundamental inequity: workers who could least afford to buy and maintain cars were also those whose transit options became less reliable or convenient during the pandemic.
          </p>
          <br>
          <p>
            For Toronto planners, this means transit investments cannot assume all riders have equal alternatives. Policies that prioritize service reliability, affordability, and safety for essential workers are not just equity measures—they are practical responses to the reality that a large segment of the workforce depends on public transit regardless of external shocks like COVID-19.
          </p>
          <br>
          <p>
            In analyzing the factors that lead to changing travel demand, it seems that the possibility of working from home will not fundamentally alter the growth in travel. Instead, it highlights the need to address the underlying structural issues that influence mobility rights in a fast-changing society. These factors shape urban form and respond to the changes that define a new transportation context.
          </p>
        </div>
      </section>

      <section id="bridge" data-controls="vis1-bar-controls"
        style="min-height: 40vh; display: flex; flex-direction: column; justify-content: center;">
        <div class="narrative-text">
          <h2>From Behavior to Impact</h2>
          <p>
            So far, we have looked at Toronto's commuting patterns through an equity lens: which essential workers continued to travel to work, and how their mode choices shifted between public transit and private vehicles. These behavioural changes matter not only for access and affordability, but also for Toronto’s climate commitments, because additional car trips from these groups add to transportation-related emissions.
          </p>
          <br>
          <p>
            In the final section, we step back to a national view and link commuting shares in 2016 and 2021 with greenhouse-gas emissions from the transportation sector. This allows you to judge whether the growth in remote work was large enough to offset higher car use, and to see how Toronto’s pattern fits within the broader Canadian trend.
          </p>
        </div>
      </section>

      <section id="vis2-section" data-controls="vis2-controls">
        <div class="narrative-text">
          <h2>3. Environmental Implications</h2>
          <h3>2016 vs. 2021: How Commuting Changed Nationally</h3>
          <p>
            Looking at the national panel, the share of how people commute shifts noticeably between 2016 and 2021.
          </p>
        </div>

        <div class="chart-container-wrapper">
          <div id="htmlwidget-1cd56ae51ed08c944d05" class="chart-container"
            style="height: 500px; box-shadow: none; padding: 0;"></div>
        </div>

        <div class="narrative-text" style="margin-top: 40px;">
          <p>
            Based on the chart, we can observe significant changes in commuting modes across the country. In particular, in 2021, the proportion of Canadians working remotely was significantly higher than in 2016. What was once uncommon has now become part of daily work routine. By contrast, public transit shows the opposite movement. In 2021, the proportion of commuters using public transit was lower than in 2016. Because we have only two census years available, we cannot observe the intermediate trends, but by 2021, public transit usage had not returned to its previous level. Meanwhile, private vehicles changed far less. Regardless of the year, cars consistently remained the primary commuting mode. Although the number of daily commuters decreased, most commuters still chose to drive.
          </p>
        </div>

        <div class="narrative-text" style="margin-top: 40px;">
          <h3>2016 vs. 2021: Where Emissions Fit into the Longer Trend</h3>
          <p>
            This chart shows the annual emissions from Canada's transportation sector, from 2010 to 2023, with special markings in 2016 and 2021 to match with the commuting data. We also highlight the sharp decline in 2020 due to the reduced travel activity during the pandemic.
          </p>
        </div>

        <div class="chart-container-wrapper">
          <div class="scatter-box">
            <div id="htmlwidget-6d77d7560fec3a86df08" class="chart-container-small"
              style="height: 500px; box-shadow: none; padding: 0;"></div>
          </div>
        </div>

        <div class="narrative-text" style="margin-top: 40px;">
          <p>
            According to the chart, transportation emissions fell to their lowest level in 2020. This directly reflects the nationwide plunge in travel and economic activity during the pandemic. In 2021, emissions rebounded but remained below 2016 levels, and later years show a gradual increase. This shows that transportation emissions are sensitive to any change in social and economic life.
          </p>
          <br>
          <p>
            For policy purposes, this chart should be read as descriptive rather than causal. It aggregates many influences on transportation emissions over time – including commuting, freight activity, fuel prices, and broader economic conditions – so we cannot say which specific factors drove the decline or rebound. What we can say with confidence is that national transportation emissions in 2021 were lower than in 2016.
          </p>
        </div>

        <div class="narrative-text" style="margin-top: 40px;">
          <h3>How the Two Stories Relate</h3>
          <p>
            By 2021, more Canadians worked from home and fewer relied on transit. Over roughly the same period, national transportation emissions were lower than in 2016.
          </p>
          <br>
          <p>
            That overlap does not establish causation. Air travel, freight activity, fuel markets, and broader economic change influenced emissions along with commuting behaviors. No single factor explains the national trend. Yet commuting does not stand in isolation from the emissions system. Fewer days of commutes suggest fewer commuter trips. Fewer trips mean less mileage traveled. Less mileage driven translates to lower fuel consumption.
          </p>
          <br>
          <p>
            Working from home did not reshape emissions itself but was part of a wider reduction in movement, which affected the transport system as a whole. The charts show association, not quantitative attribution.
          </p>
        </div>
      </section>

      <section id="external-research" data-controls="vis2-controls" style="min-height: 40vh;">
        <div class="narrative-text">
          <h2>What External Research Adds</h2>
          <p>
            Our charts cannot quantify how much emissions declined because of working from home. However, external research puts things into context. According to Statistics Canada (2021), if all jobs compatible with working remotely were done so, it is estimated that transportation-related emissions would be about 9.5 million tonnes less per year. According to a 2024 study from Carleton University, hybrid and remote work arrangements generally lead to a net reduction in transportation emissions, as fewer commute days typically translate into fewer kilometres traveled and lower fuel consumption, even after accounting for increased energy use at home (Sepanta et al., 2024).
          </p>
          <br>
          <p>
            Overall, compared with 2016, Canada had more people working from home and a smaller share commuting by public transit in 2021. Cars still dominated and emissions were below pre-2020 levels. For urban planners, this does not mean telework guarantees emissions reductions; rather, it means commuting patterns matter, and changes ripple. In particular, travel frequency, timing, and mode are interacting with emissions, along with many other forces that shape the transport system. Ultimately, remote working is not a solution in itself but rather part of the terrain on which planners are now working.
          </p>
        </div>
      </section>

      <section id="conclusion" data-controls="vis2-controls" style="min-height: 50vh;">
        <div class="narrative-text">
          <h2>Conclusion: Beyond the Remote Work Fix</h2>
          <p>
            We recognized a problem. While the pandemic fundamentally restructured commuting across Canada's largest cities, it failed to deliver a uniform shift toward sustainable mobility. The surge in remote work certainly lowered overall travel volume; however, the benefits were far from equal.
          </p>
          <br>
          <p>
            We identified a stark "flexibility gap." While white-collar professionals stayed home, low-income essential workers continued to commute daily—often navigating transit networks that became less convenient—while car dependency among the remaining commuter base remained stubbornly resilient.
          </p>
          <br>
          <p>
            This creates an environmental paradox. Although 2021 transportation emissions stayed below 2016 baselines, the data prove that remote work is not a standalone climate silver bullet. As external research corroborates, hybrid work models can shave off emissions, but they cannot offset the structural dominance of the private vehicle.
          </p>
          <br>
          <h3>Implications for Planners</h3>
          <p>
            For Toronto's urban planners, these trends pose a direct threat to meeting the targets set out in Canada's 2030 Emissions Reduction Plan. Passive reliance on telework is insufficient.
          </p>
          <br>
          <p>
            To prevent a permanent "car-led recovery," we must pivot. Infrastructure investment can no longer focus on managing peak capacity for commuters who may never return. Instead, we must prioritize the all-day mobility needs of the essential workforce. Remote work isn't the solution; it is simply the new, complex terrain on which we must build a truly equitable transit system.
          </p>
        </div>
      </section>

      <footer style="background-color: #f8f9fa; padding: 40px 0; margin-top: 60px; border-top: 2px solid #dee2e6;">
        <div class="narrative-text" style="max-width: 900px; margin: 0 auto;">
          <h3 style="margin-bottom: 20px; color: #1b5e20;">References</h3>
          
          <p style="margin-left: 2em; text-indent: -2em; margin-bottom: 15px; line-height: 1.6;">
            Government of Canada. (n.d.). <em>2030 Emissions Reduction Plan: Sector overview - Transportation sector</em>. Retrieved from <a href="https://www.canada.ca/en/services/environment/weather/climatechange/climate-plan/climate-plan-overview/emissions-reduction-2030/sector-overview.html#sector6" target="_blank" style="color: #1b5e20; text-decoration: underline;">https://www.canada.ca/en/services/environment/weather/climatechange/climate-plan/climate-plan-overview/emissions-reduction-2030/sector-overview.html#sector6</a>
          </p>
          
          <p style="margin-left: 2em; text-indent: -2em; margin-bottom: 15px; line-height: 1.6;">
            Sepanta, F., Sirati, M., & O'Brien, W. (2024). Quantifying the net impact of hybrid work on greenhouse gas emissions associated with workplace and residential energy consumption. <em>Energy and Buildings</em>.
          </p>
          
          <p style="margin-left: 2em; text-indent: -2em; margin-bottom: 30px; line-height: 1.6;">
            Statistics Canada. (2021). Working from home: Potential implications for public transit and greenhouse gas emissions. Retrieved from <a href="https://www150.statcan.gc.ca/n1/pub/36-28-0001/2021004/article/00005-eng.htm" target="_blank" style="color: #1b5e20; text-decoration: underline;">https://www150.statcan.gc.ca/n1/pub/36-28-0001/2021004/article/00005-eng.htm</a>
          </p>
          
          <h3 style="margin-bottom: 15px; color: #1b5e20;">Data Sources</h3>
          
          <p style="margin-bottom: 8px; line-height: 1.6;">
            <strong>Census data:</strong> Statistics Canada, 2016 and 2021 Census Public Use Microdata Files (PUMF)
          </p>
          
          <p style="margin-bottom: 30px; line-height: 1.6;">
            <strong>National transport emissions data:</strong> Environment and Climate Change Canada, National Inventory Report
          </p>
          
          <hr style="border: none; border-top: 1px solid #dee2e6; margin: 30px 0;">
          
          <p style="text-align: center; font-size: 0.9em; color: #666; margin: 0;">
            Dashboard created for STA313 course project, December 2025
          </p>
        </div>
      </footer>

    </main>
  </div>

  <!-- Vis0 Tooltips -->
  <div id="vis0-icon-tooltip"></div>

  <!-- 侧边栏切换和拖拽功能 -->
  <script>
    document.addEventListener('DOMContentLoaded', function () {
      const toggleBtn = document.getElementById('sidebar-toggle');
      const appContainer = document.getElementById('app-container');
      const sidebar = document.getElementById('sidebar');
      const resizer = document.getElementById('sidebar-resizer');
      
      let isResizing = false;
      let startX = 0;
      let startWidth = 0;

      // 更新切换按钮的位置
      function updateToggleButtonPosition() {
        const isHidden = appContainer.classList.contains('sidebar-hidden');
        if (isHidden) {
          toggleBtn.style.left = '20px';
        } else {
          const sidebarWidth = sidebar.offsetWidth;
          const buttonOffset = sidebarWidth - 25; // 按钮直径的一半，使其居中在边缘
          toggleBtn.style.left = buttonOffset + 'px';
        }
      }

      // 从 localStorage 读取保存的宽度
      const savedWidth = localStorage.getItem('sidebarWidth');
      if (savedWidth) {
        sidebar.style.width = savedWidth + 'px';
      }

      // 从 localStorage 读取侧边栏状态
      const sidebarHidden = localStorage.getItem('sidebarHidden') === 'true';
      if (sidebarHidden) {
        appContainer.classList.add('sidebar-hidden');
      }
      
      // 初始化按钮图标和位置
      updateToggleButtonIcon();
      updateToggleButtonPosition();
      
      // 更新按钮图标函数
      function updateToggleButtonIcon() {
        const isHidden = appContainer.classList.contains('sidebar-hidden');
        if (isHidden) {
          // 侧边栏关闭时显示菜单图标 ☰
          toggleBtn.innerHTML = `
            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M3 12h18M3 6h18M3 18h18" />
            </svg>
          `;
        } else {
          // 侧边栏打开时显示关闭图标 X
          toggleBtn.innerHTML = `
            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M18 6L6 18M6 6l12 12" />
            </svg>
          `;
        }
      }

      // 侧边栏切换功能
      toggleBtn.addEventListener('click', function () {
        // 切换时使用平滑过渡
        toggleBtn.classList.add('smooth-transition');
        
        appContainer.classList.toggle('sidebar-hidden');

        // 保存状态到 localStorage
        const isHidden = appContainer.classList.contains('sidebar-hidden');
        localStorage.setItem('sidebarHidden', isHidden);

        // 更新按钮图标和位置
        updateToggleButtonIcon();
        updateToggleButtonPosition();

        // 触发窗口 resize 事件，让图表重新调整大小
        setTimeout(() => {
          window.dispatchEvent(new Event('resize'));
        }, 300);
      });

      // 侧边栏拖拽功能
      resizer.addEventListener('mousedown', function(e) {
        isResizing = true;
        startX = e.clientX;
        startWidth = sidebar.offsetWidth;
        
        resizer.classList.add('resizing');
        // 拖拽时移除按钮的过渡动画，实现即时跟随
        toggleBtn.classList.remove('smooth-transition');
        document.body.style.cursor = 'ew-resize';
        document.body.style.userSelect = 'none';
        
        e.preventDefault();
      });

      document.addEventListener('mousemove', function(e) {
        if (!isResizing) return;
        
        const deltaX = e.clientX - startX;
        let newWidth = startWidth + deltaX;
        
        // 限制最小和最大宽度
        const minWidth = 250;
        const maxWidth = 800;
        newWidth = Math.max(minWidth, Math.min(newWidth, maxWidth));
        
        sidebar.style.width = newWidth + 'px';
        
        // 直接计算并更新按钮位置，避免读取offsetWidth造成的延迟
        const buttonOffset = newWidth - 25;
        toggleBtn.style.left = buttonOffset + 'px';
      });

      document.addEventListener('mouseup', function() {
        if (isResizing) {
          isResizing = false;
          resizer.classList.remove('resizing');
          // 拖拽结束后恢复按钮的过渡动画
          toggleBtn.classList.add('smooth-transition');
          document.body.style.cursor = '';
          document.body.style.userSelect = '';
          
          // 保存新宽度到 localStorage
          localStorage.setItem('sidebarWidth', sidebar.offsetWidth);
          
          // 触发窗口 resize 事件，让图表重新调整大小
          setTimeout(() => {
            window.dispatchEvent(new Event('resize'));
          }, 100);
        }
      });
    });
  </script>

  <script src="js/stateManager.js"></script>
  <script src="js/scrollManager.js"></script>
  <script src="js/vis0/vis0_icons.js"></script>
  <script src="js/vis0/vis0_comparison.js"></script>
  <script src="js/vis1/utils.js"></script>
  <script src="js/vis1/dataLoaderPrecomputed.js"></script>
  <script src="js/vis1/dataProcessorPrecomputed.js"></script>
  <script src="js/vis1/pieChart.js"></script>
  <script src="js/vis1/barChart.js"></script>
  <script src="js/vis1/filters.js"></script>
  <script src="js/vis1/vis1_main.js"></script>
  <script src="js/vis2/vis2_main.js"></script>
  <script src="js/vis2/logic.js"></script>
</body>

</html>